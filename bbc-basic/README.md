# Introduction

This is a (partial) implementation of mal in BBC BASIC V.  While there
is already an implementation of mal in BASIC (in the "basic"
directory), it's targeted at much more primitive versions of BASIC and
relies on a pre-processor, both of which make it fairly un-idiomatic
as a BBC BASIC V program.

BBC BASIC V is the version of BBC BASIC supplied with the first
ARM-based computers.  It has substantial enhancements from the
6502-based versions of BBC BASIC, which were themselves at the
advanced end of 8-bit BASICs.  Mal uses many of the advanced features
of BBC BASIC V and porting it to older versions would be difficult.

Mal is intended to run on all versions of BBC BASIC V and BBC BASIC
VI, as well as on Brandy 1.20.1.  For compatibility with Brandy, it
only uses features exposed in the BASIC language and does not make any
operating system calls.

# Interesting features

This appears to be the first mal implementation that uses an explicit
deterministic finite automoton (a state machine) to implement its
tokenizer.

Mal exceptions are implemented as BBC BASIC errors.  Errors generated
by mal are numbered from &40E80900.

## Assigned error numbers

No.| Description
---|------------
&00| Native mal error generated by 'throw'
&1x| Object not of type 'x'
&1F| Miscellaneous type mismatch
&20| Invalid operation on empty list
&21| Wrong number of arguments to function
&22| Undefined symbol
&23| Subscript out of range
&24| Invalid 'catch*' clause
&30| Unexpected end of input
&31| Unexpected ')'
&32| Hash-map key mush be a string
&40| File not found
&Fx| Internal errors (indicating a bug in mal)
&F0| Unprintable value
&F1| Call to non-existent core function
