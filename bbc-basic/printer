REM > printer library for mal in BBC BASIC

DEF FNpr_str(val%, print_readably%)
  LOCAL ret$
  IF FNis_nil(val%) THEN ="nil"
  IF FNis_boolean(val%) THEN
    IF FNunbox_boolean(val%) THEN ="true" ELSE ="false"
  ENDIF
  IF FNis_int(val%) THEN =STR$(FNunbox_int(val%))
  IF FNis_symbol(val%) THEN =FNunbox_symbol(val%)
  IF FNis_corefn(val%) OR FNis_fn(val%) THEN ="#<function>"
  IF FNis_list(val%) THEN
    ret$ = "("
    WHILE NOT FNis_empty(val%)
      IF LEN(ret$) > 1 THEN ret$ += " "
      ret$ += FNpr_str(FNlist_car(val%), print_readably%)
      val% = FNlist_cdr(val%)
    ENDWHILE
    =ret$ + ")"
  ENDIF
  ERROR &40E809F0, "Unprintable value"

REM Local Variables:
REM indent-tabs-mode: nil
REM End:
